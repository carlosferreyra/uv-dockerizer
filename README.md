# ğŸ³ uv-dockerizer

> A CLI tool to automatically generate optimized Dockerfiles, Docker Compose, and IaC templates for uv-based Python projects.

[![Python 3.12+](https://img.shields.io/badge/python-3.12+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![uv](https://img.shields.io/badge/uv-package%20manager-blueviolet)](https://github.com/astral-sh/uv)

## âœ¨ Features

- ï¿½ï¿½ **Smart Detection**: Automatically analyzes your Python project to detect frameworks, dependencies, and optimal configurations
- ğŸ—ï¸ **Multi-stage Builds**: Generates optimized Dockerfiles with multi-stage builds for minimal image sizes
- ğŸ”’ **Security First**: Non-root user, health checks, and security best practices out of the box
- ğŸ“¦ **Docker Compose**: Optional Docker Compose generation with service dependencies
- ğŸš€ **CI/CD Ready**: GitHub Actions and GitLab CI templates
- â˜ï¸ **Infrastructure as Code**: Terraform and Pulumi templates for AWS deployment

## ğŸ“¦ Installation

```bash
# Using uv (recommended)
uv tool install uv-dockerizer

# Or with pip
pip install uv-dockerizer
```

## ğŸš€ Quick Start

```bash
# Navigate to your uv-based Python project
cd my-python-project

# Generate Docker configuration
uvx uv-dockerizer init

# Or with additional options
uvx uv-dockerizer init --compose --ci github --iac terraform
```

## ğŸ“– Usage

### Initialize Docker Configuration

```bash
# Basic usage - analyzes project and generates Dockerfile
uv-dockerizer init

# Generate with Docker Compose
uv-dockerizer init --compose

# Generate with GitHub Actions CI
uv-dockerizer init --ci github

# Generate with Terraform IaC
uv-dockerizer init --iac terraform

# Full generation with all options
uv-dockerizer init --compose --ci github --iac terraform

# Use a specific base image
uv-dockerizer init --base-image python:3.12-alpine

# Overwrite existing files
uv-dockerizer init --force
```

### Analyze Project

```bash
# Show detected configuration without generating files
uv-dockerizer analyze
```

### Build Docker Image

```bash
# Build with auto-detected name
uv-dockerizer build

# Build with custom tag
uv-dockerizer build --tag v1.0.0

# Build and push
uv-dockerizer build --tag v1.0.0 --push
```

## ğŸ” Supported Frameworks

uv-dockerizer automatically detects and optimizes for:

| Framework | Detection | Default Port | Optimizations |
|-----------|-----------|--------------|---------------|
| FastAPI | âœ… | 8000 | uvicorn, health check |
| Flask | âœ… | 5000 | gunicorn ready |
| Django | âœ… | 8000 | static files, migrations |
| Streamlit | âœ… | 8501 | browser config |
| Celery | âœ… | - | Redis, worker setup |
| Typer/Click | âœ… | - | CLI entrypoint |

## ğŸ“ Generated Files

```
my-project/
â”œâ”€â”€ Dockerfile              # Optimized multi-stage Dockerfile
â”œâ”€â”€ .dockerignore           # Docker ignore patterns
â”œâ”€â”€ docker-compose.yml      # Docker Compose (optional)
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ docker.yml      # GitHub Actions (optional)
â””â”€â”€ infrastructure/
    â”œâ”€â”€ terraform/          # Terraform templates (optional)
    â”‚   â”œâ”€â”€ main.tf
    â”‚   â”œâ”€â”€ variables.tf
    â”‚   â””â”€â”€ outputs.tf
    â””â”€â”€ pulumi/             # Pulumi templates (optional)
        â”œâ”€â”€ Pulumi.yaml
        â”œâ”€â”€ __main__.py
        â””â”€â”€ requirements.txt
```

## ğŸ³ Example Generated Dockerfile

```dockerfile
# syntax=docker/dockerfile:1
# Generated by uv-dockerizer

# Builder stage
FROM python:3.12-slim AS builder
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/
WORKDIR /app
ENV UV_COMPILE_BYTECODE=1
ENV UV_NO_CACHE=1

COPY pyproject.toml uv.lock ./
RUN uv sync --frozen --no-install-project --no-dev

COPY . .
RUN uv sync --frozen --no-dev

# Runtime stage
FROM python:3.12-slim AS runtime
RUN groupadd --gid 1000 appgroup && \
    useradd --uid 1000 --gid appgroup --shell /bin/bash --create-home appuser
WORKDIR /app

COPY --from=builder --chown=appuser:appgroup /app/.venv /app/.venv
COPY --from=builder --chown=appuser:appgroup /app /app

ENV PATH="/app/.venv/bin:$PATH"
EXPOSE 8000
USER appuser

CMD ["uvicorn", "myapp.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- [uv](https://github.com/astral-sh/uv) - The blazingly fast Python package manager
- [Typer](https://typer.tiangolo.com/) - CLI framework
- [Rich](https://rich.readthedocs.io/) - Beautiful terminal output
